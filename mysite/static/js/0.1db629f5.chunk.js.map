{"version":3,"sources":["../node_modules/eth-json-rpc-filters/index.js","../../src/index.ts","../../src/getUniqueId.ts","../../src/JsonRpcEngine.ts","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/wrapNativeSuper.js","../node_modules/fast-safe-stringify/index.js","../../src/utils.ts","../node_modules/eth-json-rpc-filters/node_modules/eth-json-rpc-middleware/scaffold.js","../node_modules/eth-json-rpc-filters/subscriptionManager.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/nonIterableSpread.js","../node_modules/eth-block-tracker/src/base.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/superPropBase.js","../node_modules/json-rpc-random-id/index.js","../node_modules/safe-event-emitter/index.js","../../src/idRemapMiddleware.ts","../../src/createAsyncMiddleware.ts","../../src/createScaffoldMiddleware.ts","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/isNativeFunction.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/construct.js","../../src/errors.ts","../../src/mergeMiddleware.ts","../node_modules/eth-json-rpc-filters/node_modules/eth-json-rpc-middleware/node_modules/json-rpc-engine/src/createScaffoldMiddleware.js","../node_modules/eth-json-rpc-filters/log-filter.js","../node_modules/eth-json-rpc-filters/node_modules/pify/index.js","../node_modules/eth-json-rpc-filters/base-filter-history.js","../node_modules/eth-json-rpc-filters/block-filter.js","../node_modules/eth-json-rpc-filters/tx-filter.js","../node_modules/async-mutex/es6/Semaphore.js","../node_modules/async-mutex/es6/Mutex.js","../node_modules/async-mutex/es6/withTimeout.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray.js","../node_modules/eth-json-rpc-filters/hexUtils.js","../node_modules/xtend/immutable.js","../index.ts","../../src/classes.ts","../../src/error-constants.ts","../node_modules/eth-json-rpc-filters/base-filter.js","../node_modules/eth-json-rpc-filters/getBlocksForRange.js","../node_modules/eth-block-tracker/src/polling.js","../node_modules/pify/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/get.js","../node_modules/eth-query/index.js"],"names":["Mutex","require","createAsyncMiddleware","createJsonRpcMiddleware","LogFilter","BlockFilter","TxFilter","intToHex","hexToInt","toFilterCreationMiddleware","createFilterFn","toAsyncRpcMiddleware","filter","result","id","asyncFn","req","res","apply","params","objValues","obj","fn","values","key","push","module","exports","blockTracker","provider","filterIndex","filters","mutex","waitForFree","middleware","next","end","acquire","releaseLock","mutexMiddlewareWrapper","eth_newFilter","newLogFilter","eth_newBlockFilter","newBlockFilter","eth_newPendingTransactionFilter","newPendingTransactionFilter","eth_uninstallFilter","uninstallFilterHandler","eth_getFilterChanges","getFilterChanges","eth_getFilterLogs","getFilterLogs","filterUpdater","oldBlock","newBlock","length","Promise","all","map","update","console","error","uninstallFilter","destroy","uninstallAllFilters","installFilter","filterIndexHex","Error","results","getChangesAndClear","type","getAllResults","Boolean","prevFilterCount","getLatestBlock","currentBlock","initialize","idHex","newFilterCount","updateBlockTrackerSubs","on","removeListener","__exportStar","idCounter","Math","floor","random","JsonRpcEngine","_middleware","cb","Array","isArray","_handleBatch","_handle","_promiseHandle","_runAllMiddleware","middlewareError","isComplete","returnHandlers","_runReturnHandlers","handlerCallback","reqs","bind","responses","resolve","_err","callerReq","eth_rpc_errors_1","rpc","invalidRequest","request","undefined","jsonrpc","method","Object","_processRequest","_checkForCompletion","middlewareStack","_runMiddleware","reverse","err","returnHandler","internal","jsonify","handlers","handler","reject","safe_event_emitter_1","JSON","stringify","getPrototypeOf","setPrototypeOf","isNativeFunction","construct","_wrapNativeSuper","Class","_cache","Map","TypeError","has","get","set","Wrapper","arguments","this","constructor","prototype","create","value","enumerable","writable","configurable","default","stable","deterministicStringify","stableStringify","arr","replacerStack","defaultOptions","depthLimit","Number","MAX_SAFE_INTEGER","edgesLimit","replacer","spacer","options","decirc","val","k","edgeIndex","stack","parent","depth","i","setReplace","keys","pop","replaceGetterValues","_","part","defineProperty","replace","propertyDescriptor","getOwnPropertyDescriptor","compareFunction","a","b","tmp","deterministicDecirc","toJSON","sort","v","splice","call","FALLBACK_ERROR_CODE","error_constants_1","FALLBACK_MESSAGE","FALLBACK_ERROR","code","message","getMessageFromCode","fallbackMessage","isInteger","codeString","toString","hasKey","isJsonRpcServerError","isValidCode","assignOriginalError","assign","hasOwnProperty","fallbackError","shouldIncludeStack","classes_1","serialize","serialized","_error","data","originalError","_a","_b","SafeEventEmitter","createScaffoldMiddleware","createFilterMiddleware","unsafeRandomBytes","incrementHexInt","getBlocksForRange","normalizeBlock","block","hash","parentHash","sha3Uncles","miner","stateRoot","transactionsRoot","receiptsRoot","logsBloom","difficulty","number","gasLimit","gasUsed","nonce","mixHash","timestamp","extraData","subscriptions","filterManager","isDestroyed","events","eth_subscribe","eth_unsubscribe","removeAllListeners","createSubNewHeads","createSubFromFilter","subId","_emitSubscriptionResult","subscriptionType","sub","toBlock","fromBlock","rawBlocks","forEach","filterParams","subscription","filterIdHex","emit","arrayLikeToArray","iter","Symbol","iterator","from","calculateSum","accumulator","currentValue","blockTrackerEvents","BaseBlockTracker","opts","_blockResetDuration","blockResetDuration","_blockResetTimeout","_currentBlock","_isRunning","_onNewListener","_onRemoveListener","_resetCurrentBlock","_setupInternalEvents","once","latestBlock","eventName","includes","_maybeStart","_getBlockTrackerEventCount","_maybeEnd","_cancelBlockResetTimeout","_start","_setupBlockResetTimeout","_end","listenerCount","reduce","_setCurrentBlock","setTimeout","unref","clearTimeout","hexInt","parseInt","object","property","max","start","util","EventEmitter","R","Reflect","ReflectApply","target","receiver","args","Function","safeApply","context","arrayClone","n","copy","inherits","doError","_events","er","len","listeners","originalId","newId","getUniqueId_1","done","asyncMiddleware","nextPromise","resolveNextPromise","returnHandlerCallback","nextWasCalled","asyncNext","runReturnHandlersCallback","utils_1","errors_1","indexOf","isNativeReflectConstruct","_construct","Parent","instance","getEthJsonRpcError","arg","parseOpts","getEthProviderError","parse","invalidParams","methodNotFound","server","invalidInput","resourceNotFound","resourceUnavailable","transactionRejected","methodNotSupported","limitExceeded","userRejectedRequest","unauthorized","unsupportedMethod","disconnected","chainDisconnected","custom","engine","JsonRpcEngine_1","asMiddleware","EthQuery","pify","BaseFilterWithHistory","bnToHex","minBlockRef","blockRefIsNumber","ethQuery","address","topics","toLowerCase","_fetchLogs","newLogs","addInitialResults","matchingLogs","log","matchLog","addResults","getLogs","blockNumber","normalizedLogAddress","every","topicPattern","index","logTopic","subtopicsToMatch","topic","processFn","proxy","unwrapped","arguments_","P","promiseModule","multiArgs","errorFirst","shift","self","filterCache","WeakMap","input","exclude","objectType","cache","Proxy","thisArg","cached","pified","excludeMain","match","pattern","test","desc","writableOrConfigurableOwn","shouldFilter","include","some","allResults","newResults","concat","BaseFilter","blockBodies","blockHashes","blocks","blockTxHashes","transactions","Semaphore","_maxConcurrency","_queue","_value","_this","locked","isLocked","ticket","r","_dispatch","runExclusive","callback","__awaiter","release","__generator","label","sent","trys","_currentReleaser","releaser","nextConsumer","released","_semaphore","withTimeout","sync","timeout","timeoutError","isTimeout","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","sortBlockRefs","refs","refA","refB","hexString","int","unsafeRandomNibble","sortedRefs","maxBlockRef","bn","blockRef","byteCount","source","events_1","EthereumRpcError","fast_safe_stringify_1","stringifyReplacer","EthereumProviderError","isValidEthProviderCode","standard","updates","fromBlockNumber","toBlockNumber","missingBlockNumbers","fill","blockNum","query","sendAsync","PollingBlockTracker","pollingInterval","retryTimeout","keepEventLoopActive","setSkipCacheFlag","_provider","_pollingInterval","_retryTimeout","_keepEventLoopActive","_setSkipCacheFlag","_updateLatestBlock","_performSync","catch","newErr","emitErr","_fetchLatestBlock","_newPotentialLatest","skipCache","duration","timoutRef","unshift","ret","x","superPropBase","_get","base","extend","createRandomId","currentProvider","generateFnFor","methodName","slice","generateFnWithDefaultBlockFor","argCount","getBalance","getCode","getTransactionCount","getStorageAt","protocolVersion","syncing","coinbase","mining","hashrate","gasPrice","accounts","getBlockTransactionCountByHash","getBlockTransactionCountByNumber","getUncleCountByBlockHash","getUncleCountByBlockNumber","sign","sendTransaction","sendRawTransaction","estimateGas","getBlockByHash","getBlockByNumber","getTransactionByHash","getTransactionByBlockHashAndIndex","getTransactionByBlockNumberAndIndex","getTransactionReceipt","getUncleByBlockHashAndIndex","getUncleByBlockNumberAndIndex","getCompilers","compileLLL","compileSolidity","compileSerpent","newFilter","getWork","submitWork","submitHashrate","response"],"mappings":"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","file":"static/js/0.1db629f5.chunk.js","sourcesContent":["const Mutex = require('async-mutex').Mutex\nconst { createAsyncMiddleware } = require('json-rpc-engine')\nconst createJsonRpcMiddleware = require('eth-json-rpc-middleware/scaffold')\nconst LogFilter = require('./log-filter.js')\nconst BlockFilter = require('./block-filter.js')\nconst TxFilter = require('./tx-filter.js')\nconst { intToHex, hexToInt } = require('./hexUtils')\n\nmodule.exports = createEthFilterMiddleware\n\nfunction createEthFilterMiddleware({ blockTracker, provider }) {\n\n  // create filter collection\n  let filterIndex = 0\n  let filters = {}\n  // create update mutex\n  const mutex = new Mutex()\n  const waitForFree = mutexMiddlewareWrapper({ mutex })\n\n  const middleware = createJsonRpcMiddleware({\n    // install filters\n    eth_newFilter:                   waitForFree(toFilterCreationMiddleware(newLogFilter)),\n    eth_newBlockFilter:              waitForFree(toFilterCreationMiddleware(newBlockFilter)),\n    eth_newPendingTransactionFilter: waitForFree(toFilterCreationMiddleware(newPendingTransactionFilter)),\n    // uninstall filters\n    eth_uninstallFilter:             waitForFree(toAsyncRpcMiddleware(uninstallFilterHandler)),\n    // checking filter changes\n    eth_getFilterChanges:            waitForFree(toAsyncRpcMiddleware(getFilterChanges)),\n    eth_getFilterLogs:               waitForFree(toAsyncRpcMiddleware(getFilterLogs)),\n  })\n\n  // setup filter updating and destroy handler\n  const filterUpdater = async ({ oldBlock, newBlock }) => {\n    if (filters.length === 0) return\n    // lock update reads\n    const releaseLock = await mutex.acquire()\n    try {\n      // process all filters in parallel\n      await Promise.all(objValues(filters).map(async (filter) => {\n        try {\n         await filter.update({ oldBlock, newBlock })\n        } catch (err) {\n          // handle each error individually so filter update errors don't affect other filters\n          console.error(err)\n        }\n      }))\n    } catch (err) {\n      // log error so we don't skip the releaseLock\n      console.error(err)\n    }\n    // unlock update reads\n    releaseLock()\n  }\n\n  // expose filter methods directly\n  middleware.newLogFilter = newLogFilter\n  middleware.newBlockFilter = newBlockFilter\n  middleware.newPendingTransactionFilter = newPendingTransactionFilter\n  middleware.uninstallFilter = uninstallFilterHandler\n  middleware.getFilterChanges = getFilterChanges\n  middleware.getFilterLogs = getFilterLogs\n\n  // expose destroy method for cleanup\n  middleware.destroy = () => {\n    uninstallAllFilters()\n  }\n\n  return middleware\n\n  //\n  // new filters\n  //\n\n  async function newLogFilter(params) {\n    const filter = new LogFilter({ provider, params })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  async function newBlockFilter() {\n    const filter = new BlockFilter({ provider })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  async function newPendingTransactionFilter() {\n    const filter = new TxFilter({ provider })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  //\n  // get filter changes\n  //\n\n  async function getFilterChanges(filterIndexHex) {\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    if (!filter) {\n      throw new Error(`No filter for index \"${filterIndex}\"`)\n    }\n    const results = filter.getChangesAndClear()\n    return results\n  }\n\n  async function getFilterLogs(filterIndexHex) {\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    if (!filter) {\n      throw new Error(`No filter for index \"${filterIndex}\"`)\n    }\n    // only return results for log filters\n    if (filter.type === 'log') {\n      results = filter.getAllResults()\n    } else {\n      results = []\n    }\n    return results\n  }\n\n\n  //\n  // remove filters\n  //\n\n\n  async function uninstallFilterHandler(filterIndexHex) {\n    // check filter exists\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    const result = Boolean(filter)\n    // uninstall filter\n    if (result) {\n      await uninstallFilter(filterIndex)\n    }\n    return result\n  }\n\n  //\n  // utils\n  //\n\n  async function installFilter(filter) {\n    const prevFilterCount = objValues(filters).length\n    // install filter\n    const currentBlock = await blockTracker.getLatestBlock()\n    await filter.initialize({ currentBlock })\n    filterIndex++\n    filters[filterIndex] = filter\n    filter.id = filterIndex\n    filter.idHex = intToHex(filterIndex)\n    // update block tracker subs\n    const newFilterCount = objValues(filters).length\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount })\n    return filterIndex\n  }\n\n  async function uninstallFilter(filterIndex) {\n    const prevFilterCount = objValues(filters).length\n    delete filters[filterIndex]\n    // update block tracker subs\n    const newFilterCount = objValues(filters).length\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount })\n  }\n\n  async function uninstallAllFilters() {\n    const prevFilterCount = objValues(filters).length\n    filters = {}\n    // update block tracker subs\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount: 0 })\n  }\n\n  function updateBlockTrackerSubs({ prevFilterCount, newFilterCount }) {\n    // subscribe\n    if (prevFilterCount === 0 && newFilterCount > 0) {\n      blockTracker.on('sync', filterUpdater)\n      return\n    }\n    // unsubscribe\n    if (prevFilterCount > 0 && newFilterCount === 0) {\n      blockTracker.removeListener('sync', filterUpdater)\n      return\n    }\n  }\n\n}\n\n// helper for turning filter constructors into rpc middleware\nfunction toFilterCreationMiddleware(createFilterFn) {\n  return toAsyncRpcMiddleware(async (...args) => {\n    const filter = await createFilterFn(...args)\n    const result = intToHex(filter.id)\n    return result\n  })\n}\n\n// helper for pulling out req.params and setting res.result\nfunction toAsyncRpcMiddleware(asyncFn) {\n  return createAsyncMiddleware(async (req, res) => {\n    const result = await asyncFn.apply(null, req.params)\n    res.result = result\n  })\n}\n\nfunction mutexMiddlewareWrapper({ mutex }) {\n  return (middleware) => {\n    return async (req, res, next, end) => {\n      // wait for mutex available\n      // we can release immediately because\n      // we just need to make sure updates aren't active\n      const releaseLock = await mutex.acquire()\n      releaseLock()\n      middleware(req, res, next, end)\n    }\n  }\n}\n\nfunction objValues(obj, fn){\n  const values = []\n  for (let key in obj) {\n    values.push(obj[key])\n  }\n  return values\n}\n",null,null,null,"var getPrototypeOf = require(\"./getPrototypeOf\");\n\nvar setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeFunction = require(\"./isNativeFunction\");\n\nvar construct = require(\"./construct\");\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  module.exports = _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nmodule.exports = _wrapNativeSuper;","module.exports = stringify\nstringify.default = stringify\nstringify.stable = deterministicStringify\nstringify.stableStringify = deterministicStringify\n\nvar LIMIT_REPLACE_NODE = '[...]'\nvar CIRCULAR_REPLACE_NODE = '[Circular]'\n\nvar arr = []\nvar replacerStack = []\n\nfunction defaultOptions () {\n  return {\n    depthLimit: Number.MAX_SAFE_INTEGER,\n    edgesLimit: Number.MAX_SAFE_INTEGER\n  }\n}\n\n// Regular stringify\nfunction stringify (obj, replacer, spacer, options) {\n  if (typeof options === 'undefined') {\n    options = defaultOptions()\n  }\n\n  decirc(obj, '', 0, [], undefined, 0, options)\n  var res\n  try {\n    if (replacerStack.length === 0) {\n      res = JSON.stringify(obj, replacer, spacer)\n    } else {\n      res = JSON.stringify(obj, replaceGetterValues(replacer), spacer)\n    }\n  } catch (_) {\n    return JSON.stringify('[unable to serialize, circular reference is too complex to analyze]')\n  } finally {\n    while (arr.length !== 0) {\n      var part = arr.pop()\n      if (part.length === 4) {\n        Object.defineProperty(part[0], part[1], part[3])\n      } else {\n        part[0][part[1]] = part[2]\n      }\n    }\n  }\n  return res\n}\n\nfunction setReplace (replace, val, k, parent) {\n  var propertyDescriptor = Object.getOwnPropertyDescriptor(parent, k)\n  if (propertyDescriptor.get !== undefined) {\n    if (propertyDescriptor.configurable) {\n      Object.defineProperty(parent, k, { value: replace })\n      arr.push([parent, k, val, propertyDescriptor])\n    } else {\n      replacerStack.push([val, k, replace])\n    }\n  } else {\n    parent[k] = replace\n    arr.push([parent, k, val])\n  }\n}\n\nfunction decirc (val, k, edgeIndex, stack, parent, depth, options) {\n  depth += 1\n  var i\n  if (typeof val === 'object' && val !== null) {\n    for (i = 0; i < stack.length; i++) {\n      if (stack[i] === val) {\n        setReplace(CIRCULAR_REPLACE_NODE, val, k, parent)\n        return\n      }\n    }\n\n    if (\n      typeof options.depthLimit !== 'undefined' &&\n      depth > options.depthLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    if (\n      typeof options.edgesLimit !== 'undefined' &&\n      edgeIndex + 1 > options.edgesLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    stack.push(val)\n    // Optimize for Arrays. Big arrays could kill the performance otherwise!\n    if (Array.isArray(val)) {\n      for (i = 0; i < val.length; i++) {\n        decirc(val[i], i, i, stack, val, depth, options)\n      }\n    } else {\n      var keys = Object.keys(val)\n      for (i = 0; i < keys.length; i++) {\n        var key = keys[i]\n        decirc(val[key], key, i, stack, val, depth, options)\n      }\n    }\n    stack.pop()\n  }\n}\n\n// Stable-stringify\nfunction compareFunction (a, b) {\n  if (a < b) {\n    return -1\n  }\n  if (a > b) {\n    return 1\n  }\n  return 0\n}\n\nfunction deterministicStringify (obj, replacer, spacer, options) {\n  if (typeof options === 'undefined') {\n    options = defaultOptions()\n  }\n\n  var tmp = deterministicDecirc(obj, '', 0, [], undefined, 0, options) || obj\n  var res\n  try {\n    if (replacerStack.length === 0) {\n      res = JSON.stringify(tmp, replacer, spacer)\n    } else {\n      res = JSON.stringify(tmp, replaceGetterValues(replacer), spacer)\n    }\n  } catch (_) {\n    return JSON.stringify('[unable to serialize, circular reference is too complex to analyze]')\n  } finally {\n    // Ensure that we restore the object as it was.\n    while (arr.length !== 0) {\n      var part = arr.pop()\n      if (part.length === 4) {\n        Object.defineProperty(part[0], part[1], part[3])\n      } else {\n        part[0][part[1]] = part[2]\n      }\n    }\n  }\n  return res\n}\n\nfunction deterministicDecirc (val, k, edgeIndex, stack, parent, depth, options) {\n  depth += 1\n  var i\n  if (typeof val === 'object' && val !== null) {\n    for (i = 0; i < stack.length; i++) {\n      if (stack[i] === val) {\n        setReplace(CIRCULAR_REPLACE_NODE, val, k, parent)\n        return\n      }\n    }\n    try {\n      if (typeof val.toJSON === 'function') {\n        return\n      }\n    } catch (_) {\n      return\n    }\n\n    if (\n      typeof options.depthLimit !== 'undefined' &&\n      depth > options.depthLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    if (\n      typeof options.edgesLimit !== 'undefined' &&\n      edgeIndex + 1 > options.edgesLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    stack.push(val)\n    // Optimize for Arrays. Big arrays could kill the performance otherwise!\n    if (Array.isArray(val)) {\n      for (i = 0; i < val.length; i++) {\n        deterministicDecirc(val[i], i, i, stack, val, depth, options)\n      }\n    } else {\n      // Create a temporary object in the required way\n      var tmp = {}\n      var keys = Object.keys(val).sort(compareFunction)\n      for (i = 0; i < keys.length; i++) {\n        var key = keys[i]\n        deterministicDecirc(val[key], key, i, stack, val, depth, options)\n        tmp[key] = val[key]\n      }\n      if (typeof parent !== 'undefined') {\n        arr.push([parent, k, val])\n        parent[k] = tmp\n      } else {\n        return tmp\n      }\n    }\n    stack.pop()\n  }\n}\n\n// wraps replacer function to handle values we couldn't replace\n// and mark them as replaced value\nfunction replaceGetterValues (replacer) {\n  replacer =\n    typeof replacer !== 'undefined'\n      ? replacer\n      : function (k, v) {\n        return v\n      }\n  return function (key, val) {\n    if (replacerStack.length > 0) {\n      for (var i = 0; i < replacerStack.length; i++) {\n        var part = replacerStack[i]\n        if (part[1] === key && part[0] === val) {\n          val = part[2]\n          replacerStack.splice(i, 1)\n          break\n        }\n      }\n    }\n    return replacer.call(this, key, val)\n  }\n}\n",null,"// for backwards compat\nmodule.exports = require('json-rpc-engine/src/createScaffoldMiddleware')\n","const SafeEventEmitter = require('@metamask/safe-event-emitter').default\nconst createScaffoldMiddleware = require('eth-json-rpc-middleware/scaffold')\nconst { createAsyncMiddleware } = require('json-rpc-engine')\nconst createFilterMiddleware = require('./index.js')\nconst { unsafeRandomBytes, incrementHexInt } = require('./hexUtils.js')\nconst getBlocksForRange = require('./getBlocksForRange.js')\n\nmodule.exports = createSubscriptionMiddleware\n\n\nfunction createSubscriptionMiddleware({ blockTracker, provider }) {\n  // state and utilities for handling subscriptions\n  const subscriptions = {}\n  const filterManager = createFilterMiddleware({ blockTracker, provider })\n\n  // internal flag\n  let isDestroyed = false\n\n  // create subscriptionManager api object\n  const events = new SafeEventEmitter()\n  const middleware = createScaffoldMiddleware({\n    eth_subscribe: createAsyncMiddleware(subscribe),\n    eth_unsubscribe: createAsyncMiddleware(unsubscribe),\n  })\n  middleware.destroy = destroy\n  return { events, middleware }\n\n  async function subscribe(req, res) {\n\n    if (isDestroyed) throw new Error(\n      'SubscriptionManager - attempting to use after destroying'\n    )\n\n    const subscriptionType = req.params[0]\n    // subId is 16 byte hex string\n    const subId = unsafeRandomBytes(16)\n\n    // create sub\n    let sub\n    switch (subscriptionType) {\n      case 'newHeads':\n        sub = createSubNewHeads({ subId })\n        break\n      case 'logs':\n        const filterParams = req.params[1]\n        const filter = await filterManager.newLogFilter(filterParams)\n        sub = createSubFromFilter({ subId, filter })\n        break\n      default:\n        throw new Error(`SubscriptionManager - unsupported subscription type \"${subscriptionType}\"`)\n\n    }\n    subscriptions[subId] = sub\n\n    res.result = subId\n    return\n\n    function createSubNewHeads({ subId }) {\n      const sub = {\n        type: subscriptionType,\n        destroy: async () => {\n          blockTracker.removeListener('sync', sub.update)\n        },\n        update: async ({ oldBlock, newBlock }) => {\n          // for newHeads\n          const toBlock = newBlock\n          const fromBlock = incrementHexInt(oldBlock)\n          const rawBlocks = await getBlocksForRange({ provider, fromBlock, toBlock })\n          const results = rawBlocks.map(normalizeBlock)\n          results.forEach((value) => {\n            _emitSubscriptionResult(subId, value)\n          })\n        }\n      }\n      // check for subscription updates on new block\n      blockTracker.on('sync', sub.update)\n      return sub\n    }\n\n    function createSubFromFilter({ subId, filter }){\n      filter.on('update', result => _emitSubscriptionResult(subId, result))\n      const sub = {\n        type: subscriptionType,\n        destroy: async () => {\n          return await filterManager.uninstallFilter(filter.idHex)\n        },\n      }\n      return sub\n    }\n  }\n\n  async function unsubscribe(req, res) {\n\n    if (isDestroyed) throw new Error(\n      'SubscriptionManager - attempting to use after destroying'\n    )\n\n    const id = req.params[0]\n    const subscription = subscriptions[id]\n    // if missing, return \"false\" to indicate it was not removed\n    if (!subscription) {\n      res.result = false\n      return\n    }\n    // cleanup subscription\n    delete subscriptions[id]\n    await subscription.destroy()\n    res.result = true\n  }\n\n  function _emitSubscriptionResult(filterIdHex, value) {\n    events.emit('notification', {\n      jsonrpc: '2.0',\n      method: 'eth_subscription',\n      params: {\n        subscription: filterIdHex,\n        result: value,\n      },\n    })\n  }\n\n  function destroy () {\n    events.removeAllListeners()\n    for (const id in subscriptions) {\n      subscriptions[id].destroy()\n      delete subscriptions[id]\n    }\n    isDestroyed = true\n  }\n}\n\nfunction normalizeBlock(block) {\n  return {\n    hash: block.hash,\n    parentHash: block.parentHash,\n    sha3Uncles: block.sha3Uncles,\n    miner: block.miner,\n    stateRoot: block.stateRoot,\n    transactionsRoot: block.transactionsRoot,\n    receiptsRoot: block.receiptsRoot,\n    logsBloom: block.logsBloom,\n    difficulty: block.difficulty,\n    number: block.number,\n    gasLimit: block.gasLimit,\n    gasUsed: block.gasUsed,\n    nonce: block.nonce,\n    mixHash: block.mixHash,\n    timestamp: block.timestamp,\n    extraData: block.extraData,\n  }\n}\n","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","const EthQuery = require('eth-query')\nconst pify = require('pify')\nconst SafeEventEmitter = require('safe-event-emitter')\n\nconst sec = 1000\n\nconst calculateSum = (accumulator, currentValue) => accumulator + currentValue\nconst blockTrackerEvents = ['sync', 'latest']\n\nclass BaseBlockTracker extends SafeEventEmitter {\n\n  //\n  // public\n  //\n\n  constructor (opts = {}) {\n    super()\n    // config\n    this._blockResetDuration = opts.blockResetDuration || 20 * sec\n    // state\n    this._blockResetTimeout\n    this._currentBlock = null\n    this._isRunning = false\n    // bind functions for internal use\n    this._onNewListener = this._onNewListener.bind(this)\n    this._onRemoveListener = this._onRemoveListener.bind(this)\n    this._resetCurrentBlock = this._resetCurrentBlock.bind(this)\n    // listen for handler changes\n    this._setupInternalEvents()\n  }\n\n  isRunning () {\n    return this._isRunning\n  }\n\n  getCurrentBlock () {\n    return this._currentBlock\n  }\n\n  async getLatestBlock () {\n    // return if available\n    if (this._currentBlock) return this._currentBlock\n    // wait for a new latest block\n    const latestBlock = await new Promise(resolve => this.once('latest', resolve))\n    // return newly set current block\n    return latestBlock\n  }\n\n  // dont allow module consumer to remove our internal event listeners\n  removeAllListeners (eventName) {\n    // perform default behavior, preserve fn arity\n    if (eventName) {\n      super.removeAllListeners(eventName)\n    } else {\n      super.removeAllListeners()\n    }\n    // re-add internal events\n    this._setupInternalEvents()\n    // trigger stop check just in case\n    this._onRemoveListener()\n  }\n\n  //\n  // to be implemented in subclass\n  //\n\n  _start () {\n    // default behavior is noop\n  }\n\n  _end () {\n    // default behavior is noop\n  }\n\n  //\n  // private\n  //\n\n  _setupInternalEvents () {\n    // first remove listeners for idempotence\n    this.removeListener('newListener', this._onNewListener)\n    this.removeListener('removeListener', this._onRemoveListener)\n    // then add them\n    this.on('newListener', this._onNewListener)\n    this.on('removeListener', this._onRemoveListener)\n  }\n\n  _onNewListener (eventName, handler) {\n    // `newListener` is called *before* the listener is added\n    if (!blockTrackerEvents.includes(eventName)) return\n    this._maybeStart()\n  }\n\n  _onRemoveListener (eventName, handler) {\n    // `removeListener` is called *after* the listener is removed\n    if (this._getBlockTrackerEventCount() > 0) return\n    this._maybeEnd()\n  }\n\n  _maybeStart () {\n    if (this._isRunning) return\n    this._isRunning = true\n    // cancel setting latest block to stale\n    this._cancelBlockResetTimeout()\n    this._start()\n  }\n\n  _maybeEnd () {\n    if (!this._isRunning) return\n    this._isRunning = false\n    this._setupBlockResetTimeout()\n    this._end()\n  }\n\n  _getBlockTrackerEventCount () {\n    return blockTrackerEvents\n      .map(eventName => this.listenerCount(eventName))\n      .reduce(calculateSum)\n  }\n\n  _newPotentialLatest (newBlock) {\n    const currentBlock = this._currentBlock\n    // only update if blok number is higher\n    if (currentBlock && (hexToInt(newBlock) <= hexToInt(currentBlock))) return\n    this._setCurrentBlock(newBlock)\n  }\n\n  _setCurrentBlock (newBlock) {\n    const oldBlock = this._currentBlock\n    this._currentBlock = newBlock\n    this.emit('latest', newBlock)\n    this.emit('sync', { oldBlock, newBlock })\n  }\n\n  _setupBlockResetTimeout () {\n    // clear any existing timeout\n    this._cancelBlockResetTimeout()\n    // clear latest block when stale\n    this._blockResetTimeout = setTimeout(this._resetCurrentBlock, this._blockResetDuration)\n    // nodejs - dont hold process open\n    if (this._blockResetTimeout.unref) {\n      this._blockResetTimeout.unref()\n    }\n  }\n\n  _cancelBlockResetTimeout () {\n    clearTimeout(this._blockResetTimeout)\n  }\n\n  _resetCurrentBlock () {\n    this._currentBlock = null\n  }\n\n}\n\nmodule.exports = BaseBlockTracker\n\nfunction hexToInt(hexInt) {\n  return Number.parseInt(hexInt, 16)\n}\n","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;","module.exports = IdIterator\n\nfunction IdIterator(opts){\n  opts = opts || {}\n  var max = opts.max || Number.MAX_SAFE_INTEGER\n  var idCounter = typeof opts.start !== 'undefined' ? opts.start : Math.floor(Math.random() * max)\n\n  return function createRandomId () {\n    idCounter = idCounter % max\n    return idCounter++\n  }\n\n}","const util = require('util')\nconst EventEmitter = require('events/')\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n}\n\nmodule.exports = SafeEventEmitter\n\n\nfunction SafeEventEmitter() {\n  EventEmitter.call(this)\n}\n\nutil.inherits(SafeEventEmitter, EventEmitter)\n\nSafeEventEmitter.prototype.emit = function (type) {\n  // copied from https://github.com/Gozala/events/blob/master/events.js\n  // modified lines are commented with \"edited:\"\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    // edited: using safeApply\n    safeApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      // edited: using safeApply\n      safeApply(listeners[i], this, args);\n  }\n\n  return true;\n}\n\nfunction safeApply(handler, context, args) {\n  try {\n    ReflectApply(handler, context, args)\n  } catch (err) {\n    // throw error after timeout so as not to interupt the stack\n    setTimeout(() => {\n      throw err\n    })\n  }\n}\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n",null,null,null,"function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nmodule.exports = _isNativeFunction;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeReflectConstruct = require(\"./isNativeReflectConstruct\");\n\nfunction _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    module.exports = _construct = Reflect.construct;\n  } else {\n    module.exports = _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nmodule.exports = _construct;",null,null,"module.exports = function createScaffoldMiddleware (handlers) {\n  return (req, res, next, end) => {\n    const handler = handlers[req.method]\n    // if no handler, return\n    if (handler === undefined) {\n      return next()\n    }\n    // if handler is fn, call as middleware\n    if (typeof handler === 'function') {\n      return handler(req, res, next, end)\n    }\n    // if handler is some other value, use as result\n    res.result = handler\n    return end()\n  }\n}\n","const EthQuery = require('eth-query')\nconst pify = require('pify')\nconst BaseFilterWithHistory = require('./base-filter-history')\nconst { bnToHex, hexToInt, incrementHexInt, minBlockRef, blockRefIsNumber } = require('./hexUtils')\n\nclass LogFilter extends BaseFilterWithHistory {\n\n  constructor ({ provider, params }) {\n    super()\n    this.type = 'log'\n    this.ethQuery = new EthQuery(provider)\n    this.params = Object.assign({\n      fromBlock: 'latest',\n      toBlock: 'latest',\n      address: undefined,\n      topics: [],\n    }, params)\n    // normalize address parameter\n    if (this.params.address) {\n      // ensure array\n      if (!Array.isArray(this.params.address)) {\n        this.params.address = [this.params.address]\n      }\n      // ensure lowercase\n      this.params.address = this.params.address.map(address => address.toLowerCase())\n    }\n  }\n\n  async initialize({ currentBlock }) {\n    // resolve params.fromBlock\n    let fromBlock = this.params.fromBlock\n    if (['latest', 'pending'].includes(fromBlock)) fromBlock = currentBlock\n    if ('earliest' === fromBlock) fromBlock = '0x0'\n    this.params.fromBlock = fromBlock\n    // set toBlock for initial lookup\n    const toBlock = minBlockRef(this.params.toBlock, currentBlock)\n    const params = Object.assign({}, this.params, { toBlock })\n    // fetch logs and add to results\n    const newLogs = await this._fetchLogs(params)\n    this.addInitialResults(newLogs)\n  }\n\n  async update ({ oldBlock, newBlock }) {\n    // configure params for this update\n    const toBlock = newBlock\n    let fromBlock\n    // oldBlock is empty on first sync\n    if (oldBlock) {\n      fromBlock = incrementHexInt(oldBlock)\n    } else {\n      fromBlock = newBlock\n    }\n    // fetch logs\n    const params = Object.assign({}, this.params, { fromBlock, toBlock })\n    const newLogs = await this._fetchLogs(params)\n    const matchingLogs = newLogs.filter(log => this.matchLog(log))\n\n    // add to results\n    this.addResults(matchingLogs)\n  }\n\n  async _fetchLogs (params) {\n    const newLogs = await pify(cb => this.ethQuery.getLogs(params, cb))()\n    // add to results\n    return newLogs\n  }\n\n  matchLog(log) {\n    // check if block number in bounds:\n    if (hexToInt(this.params.fromBlock) >= hexToInt(log.blockNumber)) return false\n    if (blockRefIsNumber(this.params.toBlock) && hexToInt(this.params.toBlock) <= hexToInt(log.blockNumber)) return false\n\n    // address is correct:\n    const normalizedLogAddress = log.address && log.address.toLowerCase()\n    if (this.params.address && normalizedLogAddress && !this.params.address.includes(normalizedLogAddress)) return false\n\n    // topics match:\n    // topics are position-dependant\n    // topics can be nested to represent `or` [[a || b], c]\n    // topics can be null, representing a wild card for that position\n    const topicsMatch = this.params.topics.every((topicPattern, index) => {\n      // pattern is longer than actual topics\n      let logTopic = log.topics[index]\n      if (!logTopic) return false\n      logTopic = logTopic.toLowerCase()\n      // normalize subTopics\n      let subtopicsToMatch = Array.isArray(topicPattern) ? topicPattern : [topicPattern]\n      // check for wild card\n      const subtopicsIncludeWildcard = subtopicsToMatch.includes(null)\n      if (subtopicsIncludeWildcard) return true\n      subtopicsToMatch = subtopicsToMatch.map(topic => topic.toLowerCase())\n      // check each possible matching topic\n      const topicDoesMatch = subtopicsToMatch.includes(logTopic)\n      return topicDoesMatch\n    })\n\n    return topicsMatch\n  }\n\n}\n\nmodule.exports = LogFilter\n","'use strict';\n\nconst processFn = (fn, options, proxy, unwrapped) => function (...arguments_) {\n\tconst P = options.promiseModule;\n\n\treturn new P((resolve, reject) => {\n\t\tif (options.multiArgs) {\n\t\t\targuments_.push((...result) => {\n\t\t\t\tif (options.errorFirst) {\n\t\t\t\t\tif (result[0]) {\n\t\t\t\t\t\treject(result);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.shift();\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (options.errorFirst) {\n\t\t\targuments_.push((error, result) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\targuments_.push(resolve);\n\t\t}\n\n\t\tconst self = this === proxy ? unwrapped : this;\n\t\tReflect.apply(fn, self, arguments_);\n\t});\n};\n\nconst filterCache = new WeakMap();\n\nmodule.exports = (input, options) => {\n\toptions = {\n\t\texclude: [/.+(?:Sync|Stream)$/],\n\t\terrorFirst: true,\n\t\tpromiseModule: Promise,\n\t\t...options\n\t};\n\n\tconst objectType = typeof input;\n\tif (!(input !== null && (objectType === 'object' || objectType === 'function'))) {\n\t\tthrow new TypeError(`Expected \\`input\\` to be a \\`Function\\` or \\`Object\\`, got \\`${input === null ? 'null' : objectType}\\``);\n\t}\n\n\tconst filter = (target, key) => {\n\t\tlet cached = filterCache.get(target);\n\n\t\tif (!cached) {\n\t\t\tcached = {};\n\t\t\tfilterCache.set(target, cached);\n\t\t}\n\n\t\tif (key in cached) {\n\t\t\treturn cached[key];\n\t\t}\n\n\t\tconst match = pattern => (typeof pattern === 'string' || typeof key === 'symbol') ? key === pattern : pattern.test(key);\n\t\tconst desc = Reflect.getOwnPropertyDescriptor(target, key);\n\t\tconst writableOrConfigurableOwn = (desc === undefined || desc.writable || desc.configurable);\n\t\tconst included = options.include ? options.include.some(match) : !options.exclude.some(match);\n\t\tconst shouldFilter = included && writableOrConfigurableOwn;\n\t\tcached[key] = shouldFilter;\n\t\treturn shouldFilter;\n\t};\n\n\tconst cache = new WeakMap();\n\n\tconst proxy = new Proxy(input, {\n\t\tapply(target, thisArg, args) {\n\t\t\tconst cached = cache.get(target);\n\n\t\t\tif (cached) {\n\t\t\t\treturn Reflect.apply(cached, thisArg, args);\n\t\t\t}\n\n\t\t\tconst pified = options.excludeMain ? target : processFn(target, options, proxy, target);\n\t\t\tcache.set(target, pified);\n\t\t\treturn Reflect.apply(pified, thisArg, args);\n\t\t},\n\n\t\tget(target, key) {\n\t\t\tconst property = target[key];\n\n\t\t\t// eslint-disable-next-line no-use-extend-native/no-use-extend-native\n\t\t\tif (!filter(target, key) || property === Function.prototype[key]) {\n\t\t\t\treturn property;\n\t\t\t}\n\n\t\t\tconst cached = cache.get(property);\n\n\t\t\tif (cached) {\n\t\t\t\treturn cached;\n\t\t\t}\n\n\t\t\tif (typeof property === 'function') {\n\t\t\t\tconst pified = processFn(property, options, proxy, target);\n\t\t\t\tcache.set(property, pified);\n\t\t\t\treturn pified;\n\t\t\t}\n\n\t\t\treturn property;\n\t\t}\n\t});\n\n\treturn proxy;\n};\n","const BaseFilter = require('./base-filter')\n\n// tracks all results ever recorded\nclass BaseFilterWithHistory extends BaseFilter {\n\n  constructor () {\n    super()\n    this.allResults = []\n  }\n\n  async update () {\n    throw new Error('BaseFilterWithHistory - no update method specified')\n  }\n\n  addResults (newResults) {\n    this.allResults = this.allResults.concat(newResults)\n    super.addResults(newResults)\n  }\n\n  addInitialResults (newResults) {\n    this.allResults = this.allResults.concat(newResults)\n    super.addInitialResults(newResults)\n  }\n\n  getAllResults () {\n    return this.allResults\n  }\n\n}\n\nmodule.exports = BaseFilterWithHistory","const BaseFilter = require('./base-filter')\nconst getBlocksForRange = require('./getBlocksForRange')\nconst { incrementHexInt } = require('./hexUtils')\n\nclass BlockFilter extends BaseFilter {\n\n  constructor ({ provider, params }) {\n    super()\n    this.type = 'block'\n    this.provider = provider\n  }\n\n  async update ({ oldBlock, newBlock }) {\n    const toBlock = newBlock\n    const fromBlock = incrementHexInt(oldBlock)\n    const blockBodies = await getBlocksForRange({ provider: this.provider, fromBlock, toBlock })\n    const blockHashes = blockBodies.map((block) => block.hash)\n    this.addResults(blockHashes)\n  }\n\n}\n\nmodule.exports = BlockFilter\n","const BaseFilter = require('./base-filter')\nconst getBlocksForRange = require('./getBlocksForRange')\nconst { incrementHexInt } = require('./hexUtils')\n\nclass TxFilter extends BaseFilter {\n\n  constructor ({ provider }) {\n    super()\n    this.type = 'tx'\n    this.provider = provider\n  }\n\n  async update ({ oldBlock }) {\n    const toBlock = oldBlock\n    const fromBlock = incrementHexInt(oldBlock)\n    const blocks = await getBlocksForRange({ provider: this.provider, fromBlock, toBlock })\n    const blockTxHashes = []\n    for (const block of blocks) {\n      blockTxHashes.push(...block.transactions)\n    }\n    // add to results\n    this.addResults(blockTxHashes)\n  }\n\n}\n\nmodule.exports = TxFilter\n","import { __awaiter, __generator } from \"tslib\";\nvar Semaphore = /** @class */ (function () {\n    function Semaphore(_maxConcurrency) {\n        this._maxConcurrency = _maxConcurrency;\n        this._queue = [];\n        if (_maxConcurrency <= 0) {\n            throw new Error('semaphore must be initialized to a positive value');\n        }\n        this._value = _maxConcurrency;\n    }\n    Semaphore.prototype.acquire = function () {\n        var _this = this;\n        var locked = this.isLocked();\n        var ticket = new Promise(function (r) { return _this._queue.push(r); });\n        if (!locked)\n            this._dispatch();\n        return ticket;\n    };\n    Semaphore.prototype.runExclusive = function (callback) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, value, release;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.acquire()];\n                    case 1:\n                        _a = _b.sent(), value = _a[0], release = _a[1];\n                        _b.label = 2;\n                    case 2:\n                        _b.trys.push([2, , 4, 5]);\n                        return [4 /*yield*/, callback(value)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                    case 4:\n                        release();\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Semaphore.prototype.isLocked = function () {\n        return this._value <= 0;\n    };\n    Semaphore.prototype.release = function () {\n        if (this._maxConcurrency > 1) {\n            throw new Error('this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead');\n        }\n        if (this._currentReleaser) {\n            var releaser = this._currentReleaser;\n            this._currentReleaser = undefined;\n            releaser();\n        }\n    };\n    Semaphore.prototype._dispatch = function () {\n        var _this = this;\n        var nextConsumer = this._queue.shift();\n        if (!nextConsumer)\n            return;\n        var released = false;\n        this._currentReleaser = function () {\n            if (released)\n                return;\n            released = true;\n            _this._value++;\n            _this._dispatch();\n        };\n        nextConsumer([this._value--, this._currentReleaser]);\n    };\n    return Semaphore;\n}());\nexport default Semaphore;\n","import { __awaiter, __generator } from \"tslib\";\nimport Semaphore from './Semaphore';\nvar Mutex = /** @class */ (function () {\n    function Mutex() {\n        this._semaphore = new Semaphore(1);\n    }\n    Mutex.prototype.acquire = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, releaser;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this._semaphore.acquire()];\n                    case 1:\n                        _a = _b.sent(), releaser = _a[1];\n                        return [2 /*return*/, releaser];\n                }\n            });\n        });\n    };\n    Mutex.prototype.runExclusive = function (callback) {\n        return this._semaphore.runExclusive(function () { return callback(); });\n    };\n    Mutex.prototype.isLocked = function () {\n        return this._semaphore.isLocked();\n    };\n    Mutex.prototype.release = function () {\n        this._semaphore.release();\n    };\n    return Mutex;\n}());\nexport default Mutex;\n","import { __awaiter, __generator } from \"tslib\";\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function withTimeout(sync, timeout, timeoutError) {\n    var _this = this;\n    if (timeoutError === void 0) { timeoutError = new Error('timeout'); }\n    return {\n        acquire: function () {\n            return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\n                var isTimeout, ticket, release;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            isTimeout = false;\n                            setTimeout(function () {\n                                isTimeout = true;\n                                reject(timeoutError);\n                            }, timeout);\n                            return [4 /*yield*/, sync.acquire()];\n                        case 1:\n                            ticket = _a.sent();\n                            if (isTimeout) {\n                                release = Array.isArray(ticket) ? ticket[1] : ticket;\n                                release();\n                            }\n                            else {\n                                resolve(ticket);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); });\n        },\n        runExclusive: function (callback) {\n            return __awaiter(this, void 0, void 0, function () {\n                var release, ticket;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            release = function () { return undefined; };\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, , 7, 8]);\n                            return [4 /*yield*/, this.acquire()];\n                        case 2:\n                            ticket = _a.sent();\n                            if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n                            release = ticket[1];\n                            return [4 /*yield*/, callback(ticket[0])];\n                        case 3: return [2 /*return*/, _a.sent()];\n                        case 4:\n                            release = ticket;\n                            return [4 /*yield*/, callback()];\n                        case 5: return [2 /*return*/, _a.sent()];\n                        case 6: return [3 /*break*/, 8];\n                        case 7:\n                            release();\n                            return [7 /*endfinally*/];\n                        case 8: return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        release: function () {\n            sync.release();\n        },\n        isLocked: function () { return sync.isLocked(); },\n    };\n}\n","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","\nmodule.exports = {\n  minBlockRef,\n  maxBlockRef,\n  sortBlockRefs,\n  bnToHex,\n  blockRefIsNumber,\n  hexToInt,\n  incrementHexInt,\n  intToHex,\n  unsafeRandomBytes,\n}\n\nfunction minBlockRef(...refs) {\n  const sortedRefs = sortBlockRefs(refs)\n  return sortedRefs[0]\n}\n\nfunction maxBlockRef(...refs) {\n  const sortedRefs = sortBlockRefs(refs)\n  return sortedRefs[sortedRefs.length-1]\n}\n\nfunction sortBlockRefs(refs) {\n  return refs.sort((refA, refB) => {\n    if (refA === 'latest' || refB === 'earliest') return 1\n    if (refB === 'latest' || refA === 'earliest') return -1\n    return hexToInt(refA) - hexToInt(refB)\n  })\n}\n\nfunction bnToHex(bn) {\n  return '0x' + bn.toString(16)\n}\n\nfunction blockRefIsNumber(blockRef){\n  return blockRef && !['earliest', 'latest', 'pending'].includes(blockRef)\n}\n\nfunction hexToInt(hexString) {\n  if (hexString === undefined || hexString === null) return hexString\n  return Number.parseInt(hexString, 16)\n}\n\nfunction incrementHexInt(hexString){\n  if (hexString === undefined || hexString === null) return hexString\n  const value = hexToInt(hexString)\n  return intToHex(value + 1)\n}\n\nfunction intToHex(int) {\n  if (int === undefined || int === null) return int\n  let hexString = int.toString(16)\n  const needsLeftPad = hexString.length % 2\n  if (needsLeftPad) hexString = '0' + hexString\n  return '0x' + hexString\n}\n\nfunction unsafeRandomBytes(byteCount) {\n  let result = '0x'\n  for (let i = 0; i < byteCount; i++) {\n    result += unsafeRandomNibble()\n    result += unsafeRandomNibble()\n  }\n  return result\n}\n\nfunction unsafeRandomNibble() {\n  return Math.floor(Math.random() * 16).toString(16)\n}\n","module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n",null,null,null,"const SafeEventEmitter = require('@metamask/safe-event-emitter').default\n\nclass BaseFilter extends SafeEventEmitter {\n\n  constructor () {\n    super()\n    this.updates = []\n  }\n\n  async initialize () {}\n\n  async update () {\n    throw new Error('BaseFilter - no update method specified')\n  }\n\n  addResults (newResults) {\n    this.updates = this.updates.concat(newResults)\n    newResults.forEach(result => this.emit('update', result))\n  }\n\n  addInitialResults (newResults) {}\n\n  getChangesAndClear () {\n    const updates = this.updates\n    this.updates = []\n    return updates\n  }\n  \n}\n\nmodule.exports = BaseFilter\n","module.exports = getBlocksForRange\n\nasync function getBlocksForRange({ provider, fromBlock, toBlock }) {\n  if (!fromBlock) fromBlock = toBlock\n\n  const fromBlockNumber = hexToInt(fromBlock)\n  const toBlockNumber = hexToInt(toBlock)\n  const blockCountToQuery = toBlockNumber - fromBlockNumber + 1\n  // load all blocks from old to new (inclusive)\n  const missingBlockNumbers = Array(blockCountToQuery).fill()\n                              .map((_,index) => fromBlockNumber + index)\n                              .map(intToHex)\n  const blockBodies = await Promise.all(\n    missingBlockNumbers.map(blockNum => query(provider, 'eth_getBlockByNumber', [blockNum, false]))\n  )\n  return blockBodies\n}\n\nfunction hexToInt(hexString) {\n  if (hexString === undefined || hexString === null) return hexString\n  return Number.parseInt(hexString, 16)\n}\n\nfunction incrementHexInt(hexString){\n  if (hexString === undefined || hexString === null) return hexString\n  const value = hexToInt(hexString)\n  return intToHex(value + 1)\n}\n\nfunction intToHex(int) {\n  if (int === undefined || int === null) return int\n  const hexString = int.toString(16)\n  return '0x' + hexString\n}\n\nfunction query(provider, method, params) {\n  return new Promise((resolve, reject) => {\n    provider.sendAsync({ id: 1, jsonrpc: '2.0', method, params }, (err, res) => {\n      if (err) return reject(err)\n      resolve(res.result)\n    })\n  })\n}\n","const pify = require('pify')\nconst BaseBlockTracker = require('./base')\n\nconst sec = 1000\n\nclass PollingBlockTracker extends BaseBlockTracker {\n\n  constructor (opts = {}) {\n    // parse + validate args\n    if (!opts.provider) throw new Error('PollingBlockTracker - no provider specified.')\n    const pollingInterval = opts.pollingInterval || 20 * sec\n    const retryTimeout = opts.retryTimeout || pollingInterval / 10\n    const keepEventLoopActive = opts.keepEventLoopActive !== undefined ? opts.keepEventLoopActive : true\n    const setSkipCacheFlag = opts.setSkipCacheFlag || false\n    // BaseBlockTracker constructor\n    super(Object.assign({\n      blockResetDuration: pollingInterval,\n    }, opts))\n    // config\n    this._provider = opts.provider\n    this._pollingInterval = pollingInterval\n    this._retryTimeout = retryTimeout\n    this._keepEventLoopActive = keepEventLoopActive\n    this._setSkipCacheFlag = setSkipCacheFlag\n  }\n\n  //\n  // public\n  //\n\n  // trigger block polling\n  async checkForLatestBlock () {\n    await this._updateLatestBlock()\n    return await this.getLatestBlock()\n  }\n\n  //\n  // private\n  //\n\n  _start () {\n    this._performSync().catch(err => this.emit('error', err))\n  }\n\n  async _performSync () {\n    while (this._isRunning) {\n      try {\n        await this._updateLatestBlock()\n        await timeout(this._pollingInterval, !this._keepEventLoopActive)\n      } catch (err) {\n        const newErr = new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:\\n${err.stack}`)\n        try {\n          this.emit('error', newErr)\n        } catch (emitErr) {\n          console.error(newErr)\n        }\n        await timeout(this._retryTimeout, !this._keepEventLoopActive)\n      }\n    }\n  }\n\n  async _updateLatestBlock () {\n    // fetch + set latest block\n    const latestBlock = await this._fetchLatestBlock()\n    this._newPotentialLatest(latestBlock)\n  }\n\n  async _fetchLatestBlock () {\n    const req = { jsonrpc: \"2.0\", id: 1, method: 'eth_blockNumber', params: [] }\n    if (this._setSkipCacheFlag) req.skipCache = true\n    const res = await pify((cb) => this._provider.sendAsync(req, cb))()\n    if (res.error) throw new Error(`PollingBlockTracker - encountered error fetching block:\\n${res.error}`)\n    return res.result\n  }\n\n}\n\nmodule.exports = PollingBlockTracker\n\nfunction timeout (duration, unref) {\n  return new Promise(resolve => {\n    const timoutRef = setTimeout(resolve, duration)\n    // don't keep process open\n    if (timoutRef.unref && unref) {\n      timoutRef.unref()\n    }\n  })\n}\n","'use strict';\n\nconst processFn = (fn, opts) => function () {\n\tconst P = opts.promiseModule;\n\tconst args = new Array(arguments.length);\n\n\tfor (let i = 0; i < arguments.length; i++) {\n\t\targs[i] = arguments[i];\n\t}\n\n\treturn new P((resolve, reject) => {\n\t\tif (opts.errorFirst) {\n\t\t\targs.push(function (err, result) {\n\t\t\t\tif (opts.multiArgs) {\n\t\t\t\t\tconst results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (let i = 1; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i - 1] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tresults.unshift(err);\n\t\t\t\t\t\treject(results);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(results);\n\t\t\t\t\t}\n\t\t\t\t} else if (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\targs.push(function (result) {\n\t\t\t\tif (opts.multiArgs) {\n\t\t\t\t\tconst results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (let i = 0; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(results);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfn.apply(this, args);\n\t});\n};\n\nmodule.exports = (obj, opts) => {\n\topts = Object.assign({\n\t\texclude: [/.+(Sync|Stream)$/],\n\t\terrorFirst: true,\n\t\tpromiseModule: Promise\n\t}, opts);\n\n\tconst filter = key => {\n\t\tconst match = pattern => typeof pattern === 'string' ? key === pattern : pattern.test(key);\n\t\treturn opts.include ? opts.include.some(match) : !opts.exclude.some(match);\n\t};\n\n\tlet ret;\n\tif (typeof obj === 'function') {\n\t\tret = function () {\n\t\t\tif (opts.excludeMain) {\n\t\t\t\treturn obj.apply(this, arguments);\n\t\t\t}\n\n\t\t\treturn processFn(obj, opts).apply(this, arguments);\n\t\t};\n\t} else {\n\t\tret = Object.create(Object.getPrototypeOf(obj));\n\t}\n\n\tfor (const key in obj) { // eslint-disable-line guard-for-in\n\t\tconst x = obj[key];\n\t\tret[key] = typeof x === 'function' && filter(key) ? processFn(x, opts) : x;\n\t}\n\n\treturn ret;\n};\n","var superPropBase = require(\"./superPropBase\");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;","const extend = require('xtend')\nconst createRandomId = require('json-rpc-random-id')()\n\nmodule.exports = EthQuery\n\n\nfunction EthQuery(provider){\n  const self = this\n  self.currentProvider = provider\n}\n\n//\n// base queries\n//\n\n// default block\nEthQuery.prototype.getBalance =                          generateFnWithDefaultBlockFor(2, 'eth_getBalance')\nEthQuery.prototype.getCode =                             generateFnWithDefaultBlockFor(2, 'eth_getCode')\nEthQuery.prototype.getTransactionCount =                 generateFnWithDefaultBlockFor(2, 'eth_getTransactionCount')\nEthQuery.prototype.getStorageAt =                        generateFnWithDefaultBlockFor(3, 'eth_getStorageAt')\nEthQuery.prototype.call =                                generateFnWithDefaultBlockFor(2, 'eth_call')\n// standard\nEthQuery.prototype.protocolVersion =                     generateFnFor('eth_protocolVersion')\nEthQuery.prototype.syncing =                             generateFnFor('eth_syncing')\nEthQuery.prototype.coinbase =                            generateFnFor('eth_coinbase')\nEthQuery.prototype.mining =                              generateFnFor('eth_mining')\nEthQuery.prototype.hashrate =                            generateFnFor('eth_hashrate')\nEthQuery.prototype.gasPrice =                            generateFnFor('eth_gasPrice')\nEthQuery.prototype.accounts =                            generateFnFor('eth_accounts')\nEthQuery.prototype.blockNumber =                         generateFnFor('eth_blockNumber')\nEthQuery.prototype.getBlockTransactionCountByHash =      generateFnFor('eth_getBlockTransactionCountByHash')\nEthQuery.prototype.getBlockTransactionCountByNumber =    generateFnFor('eth_getBlockTransactionCountByNumber')\nEthQuery.prototype.getUncleCountByBlockHash =            generateFnFor('eth_getUncleCountByBlockHash')\nEthQuery.prototype.getUncleCountByBlockNumber =          generateFnFor('eth_getUncleCountByBlockNumber')\nEthQuery.prototype.sign =                                generateFnFor('eth_sign')\nEthQuery.prototype.sendTransaction =                     generateFnFor('eth_sendTransaction')\nEthQuery.prototype.sendRawTransaction =                  generateFnFor('eth_sendRawTransaction')\nEthQuery.prototype.estimateGas =                         generateFnFor('eth_estimateGas')\nEthQuery.prototype.getBlockByHash =                      generateFnFor('eth_getBlockByHash')\nEthQuery.prototype.getBlockByNumber =                    generateFnFor('eth_getBlockByNumber')\nEthQuery.prototype.getTransactionByHash =                generateFnFor('eth_getTransactionByHash')\nEthQuery.prototype.getTransactionByBlockHashAndIndex =   generateFnFor('eth_getTransactionByBlockHashAndIndex')\nEthQuery.prototype.getTransactionByBlockNumberAndIndex = generateFnFor('eth_getTransactionByBlockNumberAndIndex')\nEthQuery.prototype.getTransactionReceipt =               generateFnFor('eth_getTransactionReceipt')\nEthQuery.prototype.getUncleByBlockHashAndIndex =         generateFnFor('eth_getUncleByBlockHashAndIndex')\nEthQuery.prototype.getUncleByBlockNumberAndIndex =       generateFnFor('eth_getUncleByBlockNumberAndIndex')\nEthQuery.prototype.getCompilers =                        generateFnFor('eth_getCompilers')\nEthQuery.prototype.compileLLL =                          generateFnFor('eth_compileLLL')\nEthQuery.prototype.compileSolidity =                     generateFnFor('eth_compileSolidity')\nEthQuery.prototype.compileSerpent =                      generateFnFor('eth_compileSerpent')\nEthQuery.prototype.newFilter =                           generateFnFor('eth_newFilter')\nEthQuery.prototype.newBlockFilter =                      generateFnFor('eth_newBlockFilter')\nEthQuery.prototype.newPendingTransactionFilter =         generateFnFor('eth_newPendingTransactionFilter')\nEthQuery.prototype.uninstallFilter =                     generateFnFor('eth_uninstallFilter')\nEthQuery.prototype.getFilterChanges =                    generateFnFor('eth_getFilterChanges')\nEthQuery.prototype.getFilterLogs =                       generateFnFor('eth_getFilterLogs')\nEthQuery.prototype.getLogs =                             generateFnFor('eth_getLogs')\nEthQuery.prototype.getWork =                             generateFnFor('eth_getWork')\nEthQuery.prototype.submitWork =                          generateFnFor('eth_submitWork')\nEthQuery.prototype.submitHashrate =                      generateFnFor('eth_submitHashrate')\n\n// network level\n\nEthQuery.prototype.sendAsync = function(opts, cb){\n  const self = this\n  self.currentProvider.sendAsync(createPayload(opts), function(err, response){\n    if (!err && response.error) err = new Error('EthQuery - RPC Error - '+response.error.message)\n    if (err) return cb(err)\n    cb(null, response.result)\n  })\n}\n\n// util\n\nfunction generateFnFor(methodName){\n  return function(){\n    const self = this\n    var args = [].slice.call(arguments)\n    var cb = args.pop()\n    self.sendAsync({\n      method: methodName,\n      params: args,\n    }, cb)\n  }\n}\n\nfunction generateFnWithDefaultBlockFor(argCount, methodName){\n  return function(){\n    const self = this\n    var args = [].slice.call(arguments)\n    var cb = args.pop()\n    // set optional default block param\n    if (args.length < argCount) args.push('latest')\n    self.sendAsync({\n      method: methodName,\n      params: args,\n    }, cb)\n  }\n}\n\nfunction createPayload(data){\n  return extend({\n    // defaults\n    id: createRandomId(),\n    jsonrpc: '2.0',\n    params: [],\n    // user-specified\n  }, data)\n}\n"],"sourceRoot":""}